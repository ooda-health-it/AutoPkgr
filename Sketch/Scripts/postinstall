#!/bin/sh

###
#
#            Name:  postinstall
#     Description:  This postinstall script restores the extended attribute
#                   metadata for the install-sketchtool.sh script, which is
#                   required in order for Sketch.app to pass code signature
#                   verification at first launch. Packaging the app without
#                   this postinstall script results in an app that won't
#                   launch due to this missing metadata.
#                   Last tested with Sketch 3.4.2.
#          Author:  Elliot Jordan
#         Created:  2015-11-23
#   Last Modified:  2015-11-23
#         Version:  1.0
#
###

xattr -wx com.apple.cs.CodeDirectory \
"FADE0C0200000096000202000000000000000082000000340000000200000001000000A71401000000000000000000000000004F636F6D2E626F68656D69616E636F64696E672E736B6574636833005755474D5A5A354B343600A93A7120756706D7AF7188CC46D2B9BFA0B767C800000000000000000000000000000000000000005D3D084FD170407BBA7C550D52FC9022E2BCC9AF" \
"$3/Applications/Sketch.app/Contents/install-sketchtool.sh"

xattr -wx com.apple.cs.CodeRequirements \
"FADE0C01000000F000000002000000010000001C0000000300000048FADE0C000000002C0000000100000006000000020000000D636F6D2E6170706C652E656E7600000000000003FADE0C00000000A80000000100000006000000020000001A636F6D2E626F68656D69616E636F64696E672E736B65746368330000000000060000000F000000060000000E000000010000000A2A864886F76364060206000000000000000000060000000E000000000000000A2A864886F7636406010D0000000000000000000B000000000000000A7375626A6563742E4F550000000000010000000A5755474D5A5A354B34360000" \
"$3/Applications/Sketch.app/Contents/install-sketchtool.sh"

xattr -wx com.apple.cs.CodeSignature \
"308006092A864886F70D010702A0803080020101310B300906052B0E03021A0500308006092A864886F70D0107010000A0820E3630820404308202ECA0030201020208187AA9A8C296210C300D06092A864886F70D01010B05003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3132303230313232313231355A170D3237303230313232313231355A3079312D302B06035504030C24446576656C6F7065722049442043657274696669636174696F6E20417574686F7269747931263024060355040B0C1D4170706C652043657274696669636174696F6E20417574686F7269747931133011060355040A0C0A4170706C6520496E632E310B300906035504061302555330820122300D06092A864886F70D01010105000382010F003082010A028201010089764F065B9A41EEA5232B02A35FD7733FC035B08B840A3F06247FA7953FEB4F0E93AFB40ED0C83EE56D18B31FE88947BFD70908E4FF56982915E7949DB935A30ACDB4C0E1E260F4CAEC2978456969606B5F8A92FC9E23E63AC222B3314F1CBAF2B6345942EEB0A90203189104B6B3782E331F80450D456FBB0E5A5B7F3AE7D808D70B0E326DFB8636E46CABC4118A708426AA9F44D1F1B8C67B94179B48F70B5816BA23C59F15397ECA5DC3325F0FE0527F40EABEAC0864955BC91A9CE580CA1F6A441C6C3EC4B0261F1DEC7BAF5EA06A3D47A95812313F2076286D1D1CB0C24E1169268BCBD6D01182C94E0FF15674D0D9084B6678A2ABACA7E2D24C8759C90203010001A381A63081A3301D0603551D0E041604145717EDA2CFDC7C98A110E0FCBE872D2CF2E31754300F0603551D130101FF040530030101FF301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E302E0603551D1F042730253023A021A01F861D687474703A2F2F63726C2E6170706C652E636F6D2F726F6F742E63726C300E0603551D0F0101FF0404030201863010060A2A864886F7636406020604020500300D06092A864886F70D01010B050003820101004239746BA1DCC6A48F372A8CB31D0A44BC952C7FBC59B8AC61FB07909232B9D4BF3BC150396A4474A2EC5B1F70E5AADD4B6C1C23712D5FD1C593BEEE9B8A7065829D16E31A1017892DA8CDFD0C7858490C287F33EE007A1BB476ACB6B5BB4FDFA81B9DC819974A0B56672FC23EB6B3C4833AF0776D74C42E2351EE9AA5036F60F4A548A706C2BB5AE21F1F46457EE497F52710B72022726F72DAC65075C53D258F5DA300E99F368C48398FB33BEA90802E959A60F478CEF40E0A533EA2FA4FD81EAE84958D32BC564D89E97818E0AC9A42BA7A461B84A289CE14E888D1588BF6AE56C42C052A45AF0BD94BA9020F34AC88C761558944C9277307EE82E54EF570308204BB308203A3A003020102020102300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3036303432353231343033365A170D3335303230393231343033365A3062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F7420434130820122300D06092A864886F70D01010105000382010F003082010A0282010100E491A9091F91DB1E4750EB05ED5E79842DEB36A2574C55EC8B1989DEF94B6CF507AB223002E8183EF85009D37F41A898F9D1CA669C246B11D0A3BBE41B2AC31F959E7A0CA4478B5BD4163733CBC40F4DCE1469D1C91972F55D0ED57F5F9BF22503BA558F4D5D0DF1643523154B15591DB394F7F69C9ECF50BAC15850678F08B420F7CBAC2C206F70B63F01308CB743CF0F9D3DF32B49281AC8FECEB5B90ED95E1CD6CB3DB53AADF40F0E00920BB121162E74D53C0DDB6216ABA37192475355C1AF2F41B3F8FBE370CDE6A34C457E1F4C6B50964189C474620B10834187338A81B13058EC5A04328C68B38F1DDE6573FF675E65BC49D8769F331465A17794C92D0203010001A382017A30820176300E0603551D0F0101FF040403020106300F0603551D130101FF040530030101FF301D0603551D0E041604142BD06947947609FEF46B8D2E40A6F7474D7F085E301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E308201110603551D2004820108308201043082010006092A864886F7636405013081F2302A06082B06010505070201161E68747470733A2F2F7777772E6170706C652E636F6D2F6170706C6563612F3081C306082B060105050702023081B61A81B352656C69616E6365206F6E207468697320636572746966696361746520627920616E7920706172747920617373756D657320616363657074616E6365206F6620746865207468656E206170706C696361626C65207374616E64617264207465726D7320616E6420636F6E646974696F6E73206F66207573652C20636572746966696361746520706F6C69637920616E642063657274696669636174696F6E2070726163746963652073746174656D656E74732E300D06092A864886F70D010105050003820101005C36994C2D78B7ED8C9BDCF3779BF276D277304FC11F8583851B993D4737F2A99B408E2CD4B19012D8BEF4739BEED2640FCB794F34D8A23EF978FF6BC807EC7D39838B5320D338C4B1BF9A4F0A6BFF2BFC59A705097C174056111E74D3B78B233B47A3D56F24E2EBD1B770DF0F45E127CAF16D78EDE7B51717A8DC7E2235CA25D5D90FD66BD4A2242311F7A1AC8F738160C61B5B092F92B2F84448F060389E15F53D2667208A336AF70D82CFDEEBA32FF9536A5B64C0633377F73A072C56EBDA0F210EDABA73194FB5D9367FC18755D9A799B93242FBD8D5719E7EA152B71BBD934224122AC70F1DB64D9C5E63C84B801750AA8AD5DAE4FCD0090737B07575213082056B30820453A00302010202083CE6233245FAFFDE300D06092A864886F70D01010B05003079312D302B06035504030C24446576656C6F7065722049442043657274696669636174696F6E20417574686F7269747931263024060355040B0C1D4170706C652043657274696669636174696F6E20417574686F7269747931133011060355040A0C0A4170706C6520496E632E310B3009060355040613025553301E170D3132303232383039353331305A170D3137303232383039353331305A30818C311A3018060A0992268993F22C6401010C0A5755474D5A5A354B34363132303006035504030C29446576656C6F706572204944204170706C69636174696F6E3A20426F68656D69616E20436F64696E6731133011060355040B0C0A5755474D5A5A354B343631183016060355040A0C0F426F68656D69616E20436F64696E67310B3009060355040613024E4C30820122300D06092A864886F70D01010105000382010F003082010A0282010100B0902F715F07E7DAEFA1337733E4C92582F0CBA8011C98EC966E9F33D6293DB90D7A2DF69DAE35B7AF2016154BA7D3E6081B742B089A361C8901BAF0ABE1F43EC580DB9A98713597533AA11712F885A5F5545E3118E67184E37AD59E3557F08037AB8105E78EFB1B1A6E081E4F1411F3E2408B53AD91625E0A94577C6E97E1D00A1D16B24CA086FBD937234DBC1BC36E4556D060203136BEBD574F865BCB0CC8A29D74C4692968E2EA77735B2443E05672C26523316CCDC0AA11B1DBBF5839D77BE9A998206FC0F83B78C116D23F17A69732EFA25854E7A9301BC27D5BF9DA9F3EF5B43EF9343FDFCAF2E29504EC16BAD9CAFA843EBEF7B66A05963B378725CB0203010001A38201E1308201DD303E06082B0601050507010104323030302E06082B060105050730018622687474703A2F2F6F6373702E6170706C652E636F6D2F6F6373702D64657669643031301D0603551D0E04160414F02FDE0EA383643DE8805094020E3742DD1D0E55300C0603551D130101FF04023000301F0603551D230418301680145717EDA2CFDC7C98A110E0FCBE872D2CF2E317543082010E0603551D2004820105308201013081FE06092A864886F7636405013081F0302806082B06010505070201161C687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563613081C306082B060105050702023081B60C81B352656C69616E6365206F6E207468697320636572746966696361746520627920616E7920706172747920617373756D657320616363657074616E6365206F6620746865207468656E206170706C696361626C65207374616E64617264207465726D7320616E6420636F6E646974696F6E73206F66207573652C20636572746966696361746520706F6C69637920616E642063657274696669636174696F6E2070726163746963652073746174656D656E74732E300E0603551D0F0101FF04040302078030160603551D250101FF040C300A06082B060105050703033013060A2A864886F7636406010D0101FF04020500300D06092A864886F70D01010B050003820101004F795590F0CFFA2BF7C3A984293D46B612BEE11719FB27F473B527396C12B11BDBB4372D7D76F78D86890C81B743A684DE796FAC61FEF653EB0C951CE962DEC6704F232FF06E8C335E4A14A145F5EE412C3E7C0EC88625E2C562CA9DC2FB2D71B7069D1F11ED702F2DF45D519A6D1466BAAAEB74BCF35BE9850B51E9909B142F233FDE722A06CFF5FF3FB3169B8394CBBD94D0BA7C9313FB5E420E487626B3D144883DE68AFCEB76209CCEDBF32F9C25D44825DC0F5142A35E7689BB63585576846CB944E6DB0F45F216D0BB1F55F56567DBE91053A83080BC6EF271180C7B6A3B8C027AABB12AA6CBB7093F13220B47DCD4D8DFEA8D0B46332921B52396FC60318212CF308212CB0201013081853079312D302B06035504030C24446576656C6F7065722049442043657274696669636174696F6E20417574686F7269747931263024060355040B0C1D4170706C652043657274696669636174696F6E20417574686F7269747931133011060355040A0C0A4170706C6520496E632E310B300906035504061302555302083CE6233245FAFFDE300906052B0E03021A0500A05D301806092A864886F70D010903310B06092A864886F70D010701301C06092A864886F70D010905310F170D3135313131363039343435355A302306092A864886F70D01090431160414F5163CC5FB8DBFA84B6BD74B28771E581F35EB61300D06092A864886F70D010101050004820100A0F87E72F0EB3605D9BDB8E21317013BE0E0E151D0EA1822E561F4ED05AA239C5DA6658020070FCD7A807569483DFDB3B432A7E64A40ECBA08EF1F53F33960A193EEDDF992E52A724FDBE4C32545E3755D087D4464B80E3B06A5610A23704A424298EA2FA4C6D6F269F2D5C8EFE8A057719401E8B1379D86E9504274190BCEA62E3CEBA50168B7E94F9A66AC435E39FD2DF5FE5119D1911CE3AC45A3B518A6AC59EA9281E7EC5827DD9C3BB50FB8B2C25919D68264FB102417B63E6AB07F35642729FB51638241A94A5BF3F4CA64E80ACAFF9FFA4095A4B4D5E2557C356F9903996B5C0B29D931833A315EECD0E9DF5DC21D319340EB33E9B8DC2AF1904EE81FA18210BF308210BB060B2A864886F70D010910020E318210AA308210A606092A864886F70D010702A082109730821093020103310B300906052B0E03021A0500306A060B2A864886F70D0109100104A05B0459305702010106052A030405063021300906052B0E03021A050004144B9C2E0D95BA00A0EE58C042F1E884453B5B380802081336561B6D69198B180F32303135313131363039343435355A300302010102085E6DBF28819F7C58A0820DD030820502308203EAA00302010202087B64FEEC99B402C7300D06092A864886F70D01010B0500307C3130302E06035504030C274170706C652054696D657374616D702043657274696669636174696F6E20417574686F7269747931263024060355040B0C1D4170706C652043657274696669636174696F6E20417574686F7269747931133011060355040A0C0A4170706C6520496E632E310B3009060355040613025553301E170D3135313130343232323832365A170D3135313231363232323832365A3041311D301B06035504030C1454696D657374616D70205369676E6572204C4F4E31133011060355040A0C0A4170706C6520496E632E310B300906035504061302555330820122300D06092A864886F70D01010105000382010F003082010A0282010100E81F04CCEE55201BB30A760F350F3B5EFFA0F9E952BA8BFD7D92C0A605562CA2B3AC559374E9FBC4DACCE775A8A8728413502026F8D1A599DE308C86883AA7B0305201ABFD85E60809A28CCF0A0C0C7B7DE4A7BB57C7FF8CC17D2F8A75DA0764465744EDDFD12B9B31CEB013F39EF81EDAF3732980BAD63DA229AA89CFDE03942419E9AFC165F85FA6EE345301923EDF33CD124581A49E50E39B9E1081721F945C02AF9871139B09ED12425B2F6204ABE2165BEC0A664390D4843595FC0F0A6CFF8EBFC42ACF6BC5627F6DF30CBBC4FB5311067E38CA67379D471DCCFDC4EE5105B0F1C82E6F699D0E1304AED9805245B762E3A3694534BEE5C18527F1D4FF770203010001A38201C1308201BD301D0603551D0E0416041454283458708FBB145741474C10DEB00678BF51B8300C0603551D130101FF04023000301F0603551D2304183016801434CD254ECDDE378538A15826F8F9E229DEF21C933082010E0603551D2004820105308201013081FE06092A864886F7636405013081F0302806082B06010505070201161C687474703A2F2F7777772E6170706C652E636F6D2F6170706C6563613081C306082B060105050702023081B60C81B352656C69616E6365206F6E207468697320636572746966696361746520627920616E7920706172747920617373756D657320616363657074616E6365206F6620746865207468656E206170706C696361626C65207374616E64617264207465726D7320616E6420636F6E646974696F6E73206F66207573652C20636572746966696361746520706F6C69637920616E642063657274696669636174696F6E2070726163746963652073746174656D656E74732E30330603551D1F042C302A3028A026A0248622687474703A2F2F63726C2E6170706C652E636F6D2F74696D657374616D702E63726C300E0603551D0F0101FF04040302078030160603551D250101FF040C300A06082B06010505070308300D06092A864886F70D01010B050003820101009D96D4E6C315D4F015AF372CFADE59A579407A1B238D5D8B08D83032D7C0150CAEC4EDB8D053922028C787B60C2E02AD658F0BAA4F2DDA978BF4DCFE0D7A080FE695D346E0FD226D4E4E9AAEA7B6CB3AABAD3C2B6A357F335B1CD99C85CCA527ABE47B908330149E837FC0826E1251BA0956A8E6309A5473E4DB2DFDDD30358FAAA3F722ADC80E71D0485DBFAAF950FCC6B6D666F5B4695115E5FC7D5B208058EF44470B7194638FA305231D6D4FC35CD0E572FBEFDC76FEEF938A84C4E137B568ED77B7F2317635A182EFAC1F4140324012EBBC4B062C93FBC2D30288A0687D5A3A47159B0AC0557B440AF1EBC01208E800A86A4E216BA253008D2C3CF8A34030820407308202EFA00302010202087D4C57639FF3F0B7300D06092A864886F70D01010B05003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3132303430353132303234345A170D3237303430353132303234345A307C3130302E06035504030C274170706C652054696D657374616D702043657274696669636174696F6E20417574686F7269747931263024060355040B0C1D4170706C652043657274696669636174696F6E20417574686F7269747931133011060355040A0C0A4170706C6520496E632E310B300906035504061302555330820122300D06092A864886F70D01010105000382010F003082010A0282010100D37718A1F79910675CD22E9EB88F23673EFC42E2097D0A8AB818FC73402FBDC4D850C527C8FEB83470A00D133CBD084E9A936F3937DA9E65F5B463F490C8496D5D20D339FD09BAF43AF3CE4A6964059946E0DA35C465181EC616A31261B42EF5F0890D8CDC3DF606CF6F86254C09C21BC80E78888DC122B8BA21139BCAEE8A9EDD7B5BFFA3E9D1A3817EFEFFE68C49E43B0AF910A67233BB2CC44A5A720A395074DD286E795F7EA7A814CF56B3566CA5E9F0C4AEF9EA208E18C72874E2084D892642795EF660E34558A1FB51495E924A4DB9EFD473B5DA047BE3529FCBA3195DAC6B986C9EE2EC742D443EE0613E07457E34752698409B759EC830ED4BBF778F0203010001A381A63081A3301D0603551D0E0416041434CD254ECDDE378538A15826F8F9E229DEF21C93300F0603551D130101FF040530030101FF301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E302E0603551D1F042730253023A021A01F861D687474703A2F2F63726C2E6170706C652E636F6D2F726F6F742E63726C300E0603551D0F0101FF0404030201863010060A2A864886F7636406020904020500300D06092A864886F70D01010B0500038201010036D2F5DE715307C923D8789B65BCF3D55BE9B87F1B23C7A2CFB4A928E9F8DD70882139F3DB339CC37243D63D425197BAAD1D8E92D2758BC35D9CF5CB8CDC6A6A3ADDEB547DED146BF3D63E93C86D7A545FF2438E10D0765C9B000C1D4ECA3CCDFAE6F7C23E72B7B8DEE834AA15A0AE5C67A80CAC9B1E65B3E30F304234E9AED301D3A7DD4273757C5143859A6010DCAE27D26B67C933456FC9981EA09A7F4D1193E169FFEC4B45F34ECA220E57D72207E522B487E99CD345CB6E3FE58EB8FC46D55CC9B0AB053A6D3728A3A846656F55A16888EA523EC9F4D4E6FA3FA4E42680B53A6BD6C3E5F93281C832A248E18E06A319E4B3CB3B4BDFE0CC0EB2AF98D183308204BB308203A3A003020102020102300D06092A864886F70D01010505003062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F74204341301E170D3036303432353231343033365A170D3335303230393231343033365A3062310B300906035504061302555331133011060355040A130A4170706C6520496E632E31263024060355040B131D4170706C652043657274696669636174696F6E20417574686F72697479311630140603550403130D4170706C6520526F6F7420434130820122300D06092A864886F70D01010105000382010F003082010A0282010100E491A9091F91DB1E4750EB05ED5E79842DEB36A2574C55EC8B1989DEF94B6CF507AB223002E8183EF85009D37F41A898F9D1CA669C246B11D0A3BBE41B2AC31F959E7A0CA4478B5BD4163733CBC40F4DCE1469D1C91972F55D0ED57F5F9BF22503BA558F4D5D0DF1643523154B15591DB394F7F69C9ECF50BAC15850678F08B420F7CBAC2C206F70B63F01308CB743CF0F9D3DF32B49281AC8FECEB5B90ED95E1CD6CB3DB53AADF40F0E00920BB121162E74D53C0DDB6216ABA37192475355C1AF2F41B3F8FBE370CDE6A34C457E1F4C6B50964189C474620B10834187338A81B13058EC5A04328C68B38F1DDE6573FF675E65BC49D8769F331465A17794C92D0203010001A382017A30820176300E0603551D0F0101FF040403020106300F0603551D130101FF040530030101FF301D0603551D0E041604142BD06947947609FEF46B8D2E40A6F7474D7F085E301F0603551D230418301680142BD06947947609FEF46B8D2E40A6F7474D7F085E308201110603551D2004820108308201043082010006092A864886F7636405013081F2302A06082B06010505070201161E68747470733A2F2F7777772E6170706C652E636F6D2F6170706C6563612F3081C306082B060105050702023081B61A81B352656C69616E6365206F6E207468697320636572746966696361746520627920616E7920706172747920617373756D657320616363657074616E6365206F6620746865207468656E206170706C696361626C65207374616E64617264207465726D7320616E6420636F6E646974696F6E73206F66207573652C20636572746966696361746520706F6C69637920616E642063657274696669636174696F6E2070726163746963652073746174656D656E74732E300D06092A864886F70D010105050003820101005C36994C2D78B7ED8C9BDCF3779BF276D277304FC11F8583851B993D4737F2A99B408E2CD4B19012D8BEF4739BEED2640FCB794F34D8A23EF978FF6BC807EC7D39838B5320D338C4B1BF9A4F0A6BFF2BFC59A705097C174056111E74D3B78B233B47A3D56F24E2EBD1B770DF0F45E127CAF16D78EDE7B51717A8DC7E2235CA25D5D90FD66BD4A2242311F7A1AC8F738160C61B5B092F92B2F84448F060389E15F53D2667208A336AF70D82CFDEEBA32FF9536A5B64C0633377F73A072C56EBDA0F210EDABA73194FB5D9367FC18755D9A799B93242FBD8D5719E7EA152B71BBD934224122AC70F1DB64D9C5E63C84B801750AA8AD5DAE4FCD0090737B07575213182023F3082023B020101308188307C3130302E06035504030C274170706C652054696D657374616D702043657274696669636174696F6E20417574686F7269747931263024060355040B0C1D4170706C652043657274696669636174696F6E20417574686F7269747931133011060355040A0C0A4170706C6520496E632E310B300906035504061302555302087B64FEEC99B402C7300906052B0E03021A0500A0818C301A06092A864886F70D010903310D060B2A864886F70D0109100104301C06092A864886F70D010905310F170D3135313131363039343435355A302306092A864886F70D01090431160414C2E1DBABC2AD137915DEF0E9F8A4DEB63FC3BD39302B060B2A864886F70D010910020C311C301A3018301604148506A1D2AF2D391ACB4D4DF3F0BF4D27B662F198300D06092A864886F70D0101010500048201009CF7F14D7B8CFE6A726491DAA509DDDC502D90D61C647E154E7539ADB73714D529111FE45E31F9DFC22B9CDB9FC85535C3412BADC0150651283854EB01A8EC1D78DE876F68A30DB143D8F43A8CE621B5C4B98AE63C9429972C060A23AA734BF41CC26CBB2C1EAD6A33F79EAF16237DF832E24EC9F2CBC0B41B23EC1DB9FC3BD696768ADE56EDC6894E9942D95F26A0FC7A92F016A6164B5EA21595DA3BADAB045F9B680060700F8BD1EE20CC243D68749E7E85585A6474C4DBBD1EEDC581E7953FC6329713C6B0849B8860D29C6224B7CBF8659C28748F09B83CACA766C2018BFB44FFD0E1E10DA6368724244D699E14715B18A728B4C566BE992FA3D8D78F27000000000000" \
"$3/Applications/Sketch.app/Contents/install-sketchtool.sh"

exit 0
